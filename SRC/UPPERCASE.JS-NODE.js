global.NODE_CONFIG=NODE_CONFIG={},global.CPU_CLUSTERING=CPU_CLUSTERING=METHOD(function(t){"use strict";var o=require("cluster");return{run:function(e){RUN(o.isMaster?function(){var t=function(){var t=o.fork();t.on("message",function(e){EACH(o.workers,function(o){o!==t&&o.send(e)})})};REPEAT(require("os").cpus().length,function(){t()}),o.on("exit",function(o,e,n){console.log(CONSOLE_RED("[UPPERCASE.JS-CPU_CLUSTERING] WORKER #"+o.id+" (PID:"+o.process.pid+") died. ("+(void 0!==n?n:e)+"). restarting...")),t()})}:function(){var n,E,i,r=o.worker.id,a=o.worker.process.pid,R={},u=function(t,o){var e=R[t];void 0!==e&&EACH(e,function(t){t(o)})};process.on("message",function(t){var o=PARSE_STR(t);void 0!==o&&u(o.methodName,o.data)}),t.on=n=function(t,o){var e=R[t];void 0===e&&(e=R[t]=[]),e.push(o)},n("__SHARED_STORE_SAVE",SHARED_STORE.save),n("__SHARED_STORE_REMOVE",SHARED_STORE.remove),n("__CPU_SHARED_STORE_SAVE",CPU_SHARED_STORE.save),n("__CPU_SHARED_STORE_REMOVE",CPU_SHARED_STORE.remove),t.off=E=function(t){delete R[t]},t.broadcast=i=function(t){process.send(STRINGIFY(t))},e({id:r,pid:a},n,E,i),console.log(CONSOLE_GREEN("[UPPERCASE.JS-CPU_CLUSTERING] RUNNING WORKER... (ID:"+r+", PID:"+a+")"))})}}}),global.CPU_SHARED_STORE=CPU_SHARED_STORE=CLASS(function(t){"use strict";var o,e,n,E={},i={};return t.save=o=function(t,o){var e=t.fullKey,n=t.value,r=t.removeAfterSeconds,a=t.isWaitRemove;E[e]=n,a===!0&&void 0!==i[e]&&(i[e].remove(),delete i[e]),void 0!==r&&(i[e]=DELAY(r,o))},t.get=e=function(t){return E[t]},t.remove=n=function(t){delete E[t],void 0!==i[t]&&(i[t].remove(),delete i[t])},{init:function(o,e,n){var E,i,r,a;E=function(t){return n+"."+t},e.save=i=function(o){var e=o.key,n=E(e),i=o.value,r=o.removeAfterSeconds;t.save({fullKey:n,value:i,removeAfterSeconds:r},function(){a(e)}),void 0!==CPU_CLUSTERING.broadcast&&CPU_CLUSTERING.broadcast({methodName:"__CPU_SHARED_STORE_SAVE",data:{fullKey:n,value:i,isWaitRemove:void 0!==r}})},e.get=r=function(o){return t.get(E(o))},e.remove=a=function(o){var e=E(o);t.remove(e),void 0!==CPU_CLUSTERING.broadcast&&CPU_CLUSTERING.broadcast({methodName:"__CPU_SHARED_STORE_REMOVE",data:e})}}}}),global.SERVER_CLUSTERING=SERVER_CLUSTERING=METHOD(function(t){"use strict";return{run:function(o,e){var n,E,i,r,a,R=require("os"),u=o.hosts,S=o.port,c=R.networkInterfaces(),s=[],_={},d={},C={},T=[];EACH(c,function(t){return EACH(t,function(t){var o=t.address;return"IPv4"===t.family&&t.internal===!1&&(s.push(o),CHECK_IS_EXISTS({data:u,value:o})===!0)?(n=o,!1):void 0})}),void 0===n?console.log(CONSOLE_YELLOW("[UPPERCASE.JS-SERVER_CLUSTERING] NOT EXISTS MY HOST. (CLUSTER SERVER HOSTS:"),u,CONSOLE_YELLOW(", THIS SERVER HOSTS:"),s):(E=function(t){d[t]!==!0&&(d[t]=!0,CONNECT_TO_SOCKET_SERVER({host:t,port:S},{error:function(){delete d[t]},success:function(o,e,E){E({methodName:"__BOOTED",data:n}),C[t]=function(t){var o=t.methodName,e=t.data;E({methodName:"SERVER_CLUSTERING."+o,data:e})},o("__DISCONNECTED",function(){delete C[t],delete d[t]}),console.log("[UPPERCASE.JS-SERVER_CLUSTERING] CONNECTED CLUSTERING SERVER. (HOST:"+t+")"),void 0!==CPU_CLUSTERING.broadcast&&CPU_CLUSTERING.broadcast({methodName:"__SERVER_CLUSTERING__CONNECT_TO_CLUSTERING_SERVER",data:t})}}))},void 0!==CPU_CLUSTERING.on&&CPU_CLUSTERING.on("__SERVER_CLUSTERING__CONNECT_TO_CLUSTERING_SERVER",E),EACH(u,function(t){t!==n&&E(t)}),SOCKET_SERVER(S,function(t,o){T.push(o),o("__BOOTED",function(t){E(t)}),EACH(_,function(t,e){EACH(t,function(t){o("SERVER_CLUSTERING."+e,t)})}),o("__DISCONNECTED",function(){REMOVE({data:T,value:o})})}),t.on=i=function(t,o){var e=_[t];void 0===e&&(e=_[t]=[]),e.push(o),EACH(T,function(e){e("SERVER_CLUSTERING."+t,o)})},i("__SHARED_STORE_SAVE",function(t){SHARED_STORE.save(t),void 0!==CPU_CLUSTERING.broadcast&&CPU_CLUSTERING.broadcast({methodName:"__SHARED_STORE_SAVE",data:t})}),i("__SHARED_STORE_REMOVE",function(t){SHARED_STORE.remove(t),void 0!==CPU_CLUSTERING.broadcast&&CPU_CLUSTERING.broadcast({methodName:"__SHARED_STORE_REMOVE",data:t})}),t.off=r=function(t){delete _[t]},t.broadcast=a=function(t){EACH(C,function(o){o(t)})},void 0!==e&&e(n,i,r,a),console.log(CONSOLE_BLUE("[UPPERCASE.JS-SERVER_CLUSTERING] RUNNING CLUSTERING SERVER... (THIS SERVER HOST:"+n+", PORT:"+S+")")))}}}),global.SHARED_STORE=SHARED_STORE=CLASS(function(t){"use strict";var o,e,n,E={},i={};return t.save=o=function(t,o){var e=t.fullKey,n=t.value,r=t.removeAfterSeconds,a=t.isWaitRemove;E[e]=n,a===!0&&void 0!==i[e]&&(i[e].remove(),delete i[e]),void 0!==r&&(i[e]=DELAY(r,o))},t.get=e=function(t){return E[t]},t.remove=n=function(t){delete E[t],void 0!==i[t]&&(i[t].remove(),delete i[t])},{init:function(o,e,n){var E,i,r,a;E=function(t){return n+"."+t},e.save=i=function(o){var e=o.key,n=E(e),i=o.value,r=o.removeAfterSeconds;t.save({fullKey:n,value:i,removeAfterSeconds:r},function(){a(e)}),void 0!==CPU_CLUSTERING.broadcast&&CPU_CLUSTERING.broadcast({methodName:"__SHARED_STORE_SAVE",data:{fullKey:n,value:i,isWaitRemove:void 0!==r}}),void 0!==SERVER_CLUSTERING.broadcast&&SERVER_CLUSTERING.broadcast({methodName:"__SHARED_STORE_SAVE",data:{fullKey:n,value:i,isWaitRemove:void 0!==r}})},e.get=r=function(o){return t.get(E(o))},e.remove=a=function(o){var e=E(o);t.remove(e),void 0!==CPU_CLUSTERING.broadcast&&CPU_CLUSTERING.broadcast({methodName:"__SHARED_STORE_REMOVE",data:e}),void 0!==SERVER_CLUSTERING.broadcast&&SERVER_CLUSTERING.broadcast({methodName:"__SHARED_STORE_REMOVE",data:e})}}}}),global.CONNECT_TO_SOCKET_SERVER=CONNECT_TO_SOCKET_SERVER=METHOD({run:function(t,o){"use strict";var e,n,E,i,r,a,R,u,S,c=t.host,s=t.port,_=require("net"),d={},C="";CHECK_IS_DATA(o)!==!0?e=o:(e=o.success,n=o.error),S=function(t,o){var e=d[t];void 0!==e&&EACH(e,function(e){e(o,function(o){void 0!==u&&u({methodName:"__CALLBACK_"+t,data:o})})})},E=_.connect({host:c,port:s},function(){i=!0,e(a=function(t,o){var e=d[t];void 0===e&&(e=d[t]=[]),e.push(o)},R=function(t,o){var e=d[t];void 0!==e&&(void 0!==o?REMOVE({data:e,value:o}):delete d[t])},u=function(t,o){var e=t.methodName;E.write(STRINGIFY(t)+"\n"),void 0!==o&&a("__CALLBACK_"+e,function(t){o(t),R("__CALLBACK_"+e)})},function(){r=!0,E.end()})}),E.on("data",function(t){var o,e,n;for(C+=t.toString();-1!==(e=C.indexOf("\n"));)o=C.substring(0,e),n=PARSE_STR(o),void 0!==n&&S(n.methodName,n.data),C=C.substring(e+1)}),E.on("close",function(){r!==!0&&S("__DISCONNECTED")}),E.on("error",function(t){var o=t.toString();i!==!0?(console.log(CONSOLE_RED("[UPPERCASE.JS-CONNECT_TO_SOCKET_SERVER] CONNECT TO SOCKET SERVER FAILED: "+o)),void 0!==n&&n(o)):S("__ERROR",o)})}}),global.CONSOLE_BLUE=CONSOLE_BLUE=METHOD({run:function(t){"use strict";return"[36m"+t+"[0m"}}),global.CONSOLE_GREEN=CONSOLE_GREEN=METHOD({run:function(t){"use strict";return"[32m"+t+"[0m"}}),global.CONSOLE_RED=CONSOLE_RED=METHOD({run:function(t){"use strict";return"[31m"+t+"[0m"}}),global.CONSOLE_YELLOW=CONSOLE_YELLOW=METHOD({run:function(t){"use strict";return"[33m"+t+"[0m"}}),global.SHA1=SHA1=METHOD({run:function(t){"use strict";var o=t.key,e=t.password,n=require("crypto");return n.createHmac("sha1",o).update(e).digest("hex")}}),global.READ_FILE=READ_FILE=METHOD(function(){"use strict";var t=require("fs");return{run:function(o,e){var n,E,i;CHECK_IS_DATA(e)!==!0?n=e:(n=e.success,E=e.notExists,i=e.error),t.exists(o,function(e){e===!0?t.stat(o,function(e,r){var a;e!==TO_DELETE?(a=e.toString(),console.log(CONSOLE_RED("[UPPERCASE.JS-READ_FILE] ERROR: "+a)),void 0!==i&&i(a)):r.isDirectory()===!0?void 0!==E&&E(o):t.readFile(o,function(t,o){var e;t!==TO_DELETE?(e=t.toString(),console.log(CONSOLE_RED("[UPPERCASE.JS-READ_FILE] ERROR: "+e)),void 0!==i&&i(e)):n(o)})}):void 0!==E&&E(o)})}}}),global.WRITE_FILE=WRITE_FILE=METHOD(function(){"use strict";var t=require("fs"),o=require("path");return{run:function(e,n){var E,i,r=e.path,a=e.content;CHECK_IS_DATA(n)!==!0?E=n:(E=n.success,i=n.error),NEXT([function(e){var n=function(e,E){t.exists(e,function(i){var r;i===!0?E():(r=o.dirname(e),t.exists(r,function(o){o===!0?t.mkdir(e,E):n(r,function(){n(e,E)})}))})};n(o.dirname(r),e)},function(){return function(){t.writeFile(r,a,function(t){var o;t!==TO_DELETE?(o=t.toString(),console.log(CONSOLE_RED("[UPPERCASE.JS-WRITE_FILE] ERROR:"+o)),void 0!==i&&i(o)):E()})}}])}}}),global.DELETE=DELETE=METHOD({run:function(t,o){"use strict";REQUEST(COMBINE_DATA({origin:t,extend:{method:"DELETE"}}),o)}}),global.GET=GET=METHOD({run:function(t,o){"use strict";REQUEST(COMBINE_DATA({origin:t,extend:{method:"GET"}}),o)}}),global.POST=POST=METHOD({run:function(t,o){"use strict";REQUEST(COMBINE_DATA({origin:t,extend:{method:"POST"}}),o)}}),global.PUT=PUT=METHOD({run:function(t,o){"use strict";REQUEST(COMBINE_DATA({origin:t,extend:{method:"PUT"}}),o)}}),global.REQUEST=REQUEST=METHOD({run:function(t,o){"use strict";var e,n,E,i=require("http"),r=void 0===t.host?"localhost":t.host,a=void 0===t.port?80:t.port,R=t.method,u=t.uri,S=void 0!==t.data?"data="+encodeURIComponent(STRINGIFY(t.data)):t.paramStr;CHECK_IS_DATA(o)!==!0?e=o:(e=o.success,n=o.error),S=(void 0===S?"":S+"&")+Date.now(),R=R.toUpperCase(),"GET"===R?E=i.get({hostname:r,port:a,path:"/"+u+"?"+S},function(t){t.setEncoding("utf-8"),t.on("data",function(t){e(t)})}):(E=i.request({hostname:r,port:a,path:"/"+u,method:R},function(t){t.setEncoding("utf-8"),t.on("data",function(t){e(t)})}),E.write(S),E.end()),E.on("error",function(o){var e=o.toString();console.log(CONSOLE_RED("[UPPERCASE.JS-NODE] REQUEST FAILED: "+e),t),void 0!==n&&n(e)})}}),global.RESOURCE_SERVER=RESOURCE_SERVER=METHOD(function(t){"use strict";var o,e=require("path");return t.getContentTypeFromURI=o=function(t){var o=e.extname(t);return".png"===o?"image/png":".jpeg"===o||".jpg"===o?"image/jpeg":".gif"===o?"image/gif":".js"===o?"text/javascript":".json"===o?"application/json":".css"===o?"text/css":".text"===o||".txt"===o?"text/plain":".html"===o?"text/html":".swf"===o?"application/x-shockwave-flash":".mp3"===o?"audio/mpeg":"application/octet-stream"},{run:function(t,e){{var n,E,i,r=(require("path"),t.port),a=t.securedPort,R=t.rootPath;t.version}void 0!==e&&(CHECK_IS_DATA(e)!==!0?n=e:(n=e.requestListener,E=e.error,i=e.notExists)),WEB_SERVER(t,function(t,e,r){var a,u,S,c,s,_=R;void 0!==n&&(a=n(t,e,r,function(t){_=t})),u=t.uri,S=t.method,a!==!1&&t.isResponsed!==!0&&"GET"===S&&(c=function(o){void 0!==i&&i(o,t,e),t.isResponsed!==!0&&e({statusCode:404})},s=function(o){console.log(CONSOLE_RED("[UPPERCASE.JS-RESOURCE_SERVER] ERROR: "+o)),void 0!==E&&E(o,t,e),t.isResponsed!==!0&&e({statusCode:500})},NEXT([function(t){READ_FILE(_+"/"+u,{notExists:function(){READ_FILE(_+(""===u?"":"/"+u)+"/index.html",{notExists:c,error:s,success:function(o){t(o,"text/html")}})},error:s,success:t})},function(){return function(t,n){void 0===n&&(n=o(u)),e({content:t,contentType:n})}}]))}),console.log("[UPPERCASE.JS-RESOURCE_SERVER] RUNNING RESOURCE SERVER..."+(void 0===r?"":" (PORT:"+r+")")+(void 0===a?"":" (SECURED PORT:"+a+")"))}}}),global.SOCKET_SERVER=SOCKET_SERVER=METHOD({run:function(t,o){"use strict";var e=require("net"),n=e.createServer(function(t){var e,n,E,i,r={},a="",R=function(t,o){var e=r[t];void 0!==e&&EACH(e,function(e){e(o,function(o){i({methodName:"__CALLBACK_"+t,data:o})})})};t.on("data",function(t){var o,e,n;for(a+=t.toString();-1!==(e=a.indexOf("\n"));)o=a.substring(0,e),n=PARSE_STR(o),void 0!==n&&R(n.methodName,n.data),a=a.substring(e+1)}),t.on("close",function(){e!==!0&&R("__DISCONNECTED"),r=void 0}),t.on("error",function(t){R("__ERROR",t)}),o({ip:t.remoteAddress},n=function(t,o){var e=r[t];void 0===e&&(e=r[t]=[]),e.push(o)},E=function(t,o){var e=r[t];void 0!==e&&(void 0!==o?REMOVE({data:e,value:o}):delete r[t])},i=function(o,e){var i=o.methodName;t.write(STRINGIFY(o)+"\n"),void 0!==e&&n("__CALLBACK_"+i,function(t){e(t),E("__CALLBACK_"+i)})},function(){e=!0,t.end()})});n.listen(t),console.log("[UPPERCASE.JS-SOCKET_SERVER] RUNNING SOCKET SERVER... (PORT:"+t+")")}}),global.WEB_SERVER=WEB_SERVER=METHOD(function(t){"use strict";var o;return t.getEncodingFromContentType=o=function(t){return"text/javascript"===t?"utf-8":"text/css"===t?"utf-8":"text/plain"===t?"binary":"text/html"===t?"utf-8":"image/png"===t?"binary":"image/jpeg"===t?"binary":"image/gif"===t?"binary":"application/x-shockwave-flash"===t?"binary":"audio/mpeg"===t?"binary":"binary"},{run:function(t,e){var n,E,i,r,a,R=require("http"),u=require("querystring");CHECK_IS_DATA(t)!==!0?n=t:(n=t.port,E=t.securedPort,i=t.securedKeyFilePath,r=t.securedCertFilePath),a=function(t,n){var E,i,r=t.headers,a=t.url,R=t.method.toUpperCase(),S=r["X-Forwarded-For"],c=[];void 0===S&&(S=t.connection.remoteAddress),-1!=a.indexOf("?")&&(E=a.substring(a.indexOf("?")+1),a=a.substring(0,a.indexOf("?"))),a=a.substring(1),NEXT([function(o){"GET"===R?o():(t.on("data",function(t){void 0===E&&(E=""),E+=t}),t.on("end",function(){o()}))},function(){return function(){e(i={headers:r,uri:a,method:R,params:u.parse(E),ip:S,cookies:PARSE_COOKIE_STR(r.cookie),nativeReq:t},function(t){var e,E,r,a,R,u;i.isResponsed!==!0&&(void 0!==t&&(e=t.statusCode,E=t.headers,r=t.contentType,a=t.content,R=t.encoding,u=t.cacheTime),void 0===e&&(e=200),void 0===E&&(E={}),void 0!==r&&(E["Content-Type"]=r,void 0===R&&(R=o(r))),void 0!==u&&(E.ETag=u,E["Last-Modified"]=new Date(u).toUTCString()),n.writeHead(e,E),n.end(a,R),i.isResponsed=!0)},function(t){c.push(t)})}}]),t.on("close",function(){EACH(c,function(t){t()})})},void 0!==n&&R.createServer(a).listen(n),void 0!==E&&https.createServer({key:fs.readFileSync(i),cert:fs.readFileSync(r)},a).listen(E),console.log("[UPPERCASE.JS-WEB_SERVER] RUNNING WEB SERVER..."+(void 0===n?"":" (PORT:"+n+")")+(void 0===E?"":" (SECURED PORT:"+E+")"))}}}),global.PARSE_COOKIE_STR=PARSE_COOKIE_STR=METHOD({run:function(t){"use strict";var o,e={};return void 0!==t&&(o=t.split(";"),EACH(o,function(t){var o=t.split("=");e[o[0].trim()]=decodeURIComponent(o[1])})),e}}),global.CREATE_COOKIE_STR_ARRAY=CREATE_COOKIE_STR_ARRAY=METHOD({run:function(t){"use strict";var o=[];return EACH(t,function(t,e){o.push(e+"="+encodeURIComponent(t))}),o}});