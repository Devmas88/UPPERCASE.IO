FOR_BOX(function(o){"use strict";o.MODEL=CLASS({init:function(i,e,t){var n,d,v,r,a,c,u,s,E,f,A,O,h,m,C,l,M,R,g,D,_,N,H,x,T,I,S,V,p,L,K,P=t.name,k=t.config,U=o.ROOM(P),b={},w={},W=[],X=[],B={},F=function(i){console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+P+"` ERROR: "+i)},j=function(){console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+P+"` NOT EXISTS!")},q=function(i){console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+P+"` NOT VALID!: ",i)},y=function(){console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+P+"` NOT AUTHED!")};e.getName=h=function(){return P},void 0!==k&&(n=k.create,d=k.get,v=k.update,r=k.remove,a=k.find,c=k.count,u=k.checkIsExists,void 0!==n&&(s=n.valid,f=n.initData),void 0!==v&&(E=v.valid)),i.getCreateValid=m=function(){return s},i.getUpdateValid=C=function(){return E},i.initData=l=function(o){return void 0!==f&&f(o),o},e.getRoom=M=function(){return U},n!==!1&&(e.create=R=function(o,i){var e,t,n,d,v;void 0!==l&&l(o),REMOVE_TO_DELETE(o),void 0!==i&&(CHECK_IS_DATA(i)!==!0?e=i:(e=i.success,t=i.notValid,n=i.notAuthed,d=i.error)),void 0!==s&&(v=s.check(o)),void 0!==v&&v.checkHasError()===!0?void 0!==t?t(v.getErrors()):q(v.getErrors()):U.send({methodName:"create",data:o},function(o){var i=o.errorMsg,v=o.validErrors,r=o.isNotAuthed,a=o.savedData;void 0!==i?(F(i),void 0!==d&&d(i)):void 0!==v?void 0!==t?t(v):q(v):r===!0?void 0!==n?n():y():void 0!==e&&e(a)}),REMOVE_TO_DELETE(o)}),d!==!1&&(e.get=g=function(o,i){var e,t,n,d;void 0===i&&(i=o,o=void 0),CHECK_IS_DATA(i)!==!0?e=i:(e=i.success,t=i.notExists,n=i.notAuthed,d=i.error),U.send({methodName:"get",data:o},function(o){var i,v,r;void 0!==o&&(i=o.errorMsg,v=o.isNotAuthed,r=o.savedData),void 0!==i?(F(i),void 0!==d&&d(i)):v===!0?void 0!==n?n():y():void 0===r?void 0!==t?t():j():void 0!==e&&e(r)})},e.getWatching=D=function(i,e){var t,n,d,v;void 0===e&&(e=i,i=void 0),CHECK_IS_DATA(e)!==!0?t=e:(t=e.success,n=e.notExists,d=e.notAuthed,v=e.error),g(i,{success:function(i){var e,n;void 0!==t&&(W.push(e=o.ROOM(P+"/"+i.id)),t(i,function(o){e.on("update",o)},function(o){e.on("remove",function(i){o(i),n()})},n=function(){REMOVE({data:W,value:e}),e.exit()}))},notExists:n,notAuthedHandler:d,errorHandler:v})}),v!==!1&&(e.update=_=function(o,i){var e,t,n,d,v,r;void 0!==i&&(CHECK_IS_DATA(i)!==!0?e=i:(e=i.success,t=i.notValid,n=i.notExists,d=i.notAuthed,v=i.error)),REMOVE_TO_DELETE(o),void 0!==E&&(r=E.checkExceptUndefined(o)),void 0!==E&&r.checkHasError()===!0?void 0!==t?t(r.getErrors()):q(r.getErrors()):U.send({methodName:"update",data:o},function(o){var i,r,a,c;void 0!==o&&(i=o.errorMsg,r=o.validErrors,a=o.isNotAuthed,c=o.savedData),void 0!==i?(F(i),void 0!==v&&v(i)):void 0!==r?void 0!==t?t(r):q(r):a===!0?void 0!==d?d():y():void 0===c?void 0!==n?n():j():void 0!==e&&e(c)}),REMOVE_TO_DELETE(o)}),r!==!1&&(e.remove=N=function(o,i){var e,t,n,d;void 0!==i&&(CHECK_IS_DATA(i)!==!0?e=i:(e=i.success,t=i.notExists,n=i.notAuthed,d=i.error)),U.send({methodName:"remove",data:o},function(o){var i,v,r;void 0!==o&&(i=o.errorMsg,v=o.isNotAuthed,r=o.savedData),void 0!==i?(F(i),void 0!==d&&d(i)):v===!0?void 0!==n?n():y():void 0===r?void 0!==t?t():j():void 0!==e&&e(r)})}),a!==!1&&(e.find=H=function(o,i){var e,t,n;void 0===i&&(i=o,o=void 0),void 0!==i&&(CHECK_IS_DATA(i)!==!0?e=i:(e=i.success,t=i.notAuthed,n=i.error)),U.send({methodName:"find",data:o},function(o){var i=o.errorMsg,d=o.isNotAuthed,v=o.savedDataSet;void 0!==i?(F(i),void 0!==n&&n(i)):d===!0?void 0!==t?t():y():void 0!==e&&e(v)})},e.findWatching=x=function(i,e){var t,n,d;void 0===e&&(e=i,i=void 0),void 0!==e&&(CHECK_IS_DATA(e)!==!0?t=e:(t=e.success,n=e.notAuthed,d=e.error)),H(i,{success:function(i){var e,n={};void 0!==t&&(EACH(i,function(i){var e=i.id;W.push(n[e]=o.ROOM(P+"/"+e))}),t(i,function(o,i){n[o].on("update",i)},function(o,i){n[o].on("remove",function(t){i(t),e(o)})},e=function(o){void 0!==n[o]&&(REMOVE({data:W,value:n[o]}),n[o].exit(),delete n[o])}))},notAuthedHandler:n,errorHandler:d})}),c!==!1&&(e.count=T=function(o,i){var e,t,n;void 0===i&&(i=o,o=void 0),void 0!==i&&(CHECK_IS_DATA(i)!==!0?e=i:(e=i.success,t=i.notAuthed,n=i.error)),U.send({methodName:"count",data:o},function(o){var i=o.errorMsg,d=o.isNotAuthed,v=o.count;void 0!==i?(F(i),void 0!==n&&n(i)):d===!0?void 0!==t?t():y():void 0!==e&&e(v)})}),u!==!1&&(e.checkIsExists=I=function(o,i){var e,t,n;void 0===i&&(i=o,o=void 0),void 0!==i&&(CHECK_IS_DATA(i)!==!0?e=i:(e=i.success,t=i.notAuthed,n=i.error)),U.send({methodName:"checkIsExists",data:o},function(o){var i=o.errorMsg,d=o.isNotAuthed,v=o.isExists;void 0!==i?(F(i),void 0!==n&&n(i)):d===!0?void 0!==t?t():y():void 0!==e&&e(v)})}),e.onNew=S=function(i,e){var t=function(o){o.id;e(o)};void 0===e?(e=i,void 0===A&&(A=o.ROOM(P+"/create")),A.on("create",t)):EACH(i,function(i,e){var n=b[e+"/"+i];void 0===n&&(n=b[e+"/"+i]=o.ROOM(P+"/"+e+"/"+i+"/create")),n.on("create",t)})},e.onNewWatching=V=function(i,e){var t=function(i,t){var n,d,v=i.id;W.push(n=o.ROOM(P+"/"+v)),t.push(n),e(i,function(o){n.on("update",o)},function(o){n.on("remove",function(i){o(i),d()})},d=function(){n.exit(),REMOVE({data:W,value:n})})};void 0===e?(e=i,void 0===A&&(A=o.ROOM(P+"/create")),A.on("create",function(o){t(o,X)})):EACH(i,function(i,e){var n=b[e+"/"+i],d=B[e+"/"+i];void 0===n&&(n=b[e+"/"+i]=o.ROOM(P+"/"+e+"/"+i+"/create")),void 0===d&&(d=B[e+"/"+i]=[]),n.on("create",function(o){t(o,d)})})},e.closeOnNew=p=function(o){void 0===o?(void 0!==A&&(A.exit(),A=void 0),EACH(X,function(o){o.exit(),REMOVE({data:W,value:o})}),X=[]):EACH(o,function(o,i){void 0!==b[i+"/"+o]&&(b[i+"/"+o].exit(),delete b[i+"/"+o]),EACH(B[i+"/"+o],function(o){o.exit(),REMOVE({data:W,value:o})}),delete B[i+"/"+o]})},e.onRemove=L=function(i,e){var t=function(o){o.id;e(o)};void 0===e?(e=i,void 0===O&&(O=o.ROOM(P+"/remove")),O.on("remove",t)):EACH(i,function(i,e){var n=w[e+"/"+i];void 0===n&&(n=w[e+"/"+i]=o.ROOM(P+"/"+e+"/"+i+"/remove")),n.on("remove",t)})},e.closeOnRemove=K=function(o){void 0===o?void 0!==O&&(O.exit(),O=void 0):EACH(o,function(o,i){void 0!==w[i+"/"+o]&&(w[i+"/"+o].exit(),delete w[i+"/"+o])})}}})});