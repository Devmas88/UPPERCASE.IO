FOR_BOX(function(o){"use strict";OVERRIDE(o.MODEL,function(){o.MODEL=CLASS({init:function(t,i,r){var e,n,a,c,d,u,v,s,f,E,C,A,S,m,D,_,h,l,H,I,g,T,N,O,p,M,R,x,K,X,k,B,b,L,V,U,F,P=r.name,j=r.config,q=[],w=[],y=[],z=[],G=[],J=[],Q=[],W=[],Y=[],Z=[],$=o.DB(P),ot=function(t){console.log(CONSOLE_RED("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+P+"` ERROR: "+t))};i.getName=l=function(){return P},void 0!==j&&(e=j.create,n=j.get,a=j.update,c=j.remove,d=j.find,u=j.count,v=j.checkIsExists,void 0!==e&&(s=e.valid,E=e.role,h=e.initData),void 0!==n&&(C=n.role),void 0!==a&&(f=a.valid,A=a.role),void 0!==c&&(S=c.role),void 0!==d&&(m=d.role),void 0!==u&&(D=u.role),void 0!==v&&(_=v.role)),t.getCreateValid=H=function(){return s},t.getUpdateValid=I=function(){return f},t.initData=g=function(o){return void 0!==h&&h(o),o},i.getDB=T=function(){return $},t.on=N=function(o,t){"create"===o?(void 0!==t.before&&q.push(t.before),void 0!==t.after&&w.push(t.after)):"get"===o?y.push(t):"update"===o?(void 0!==t.before&&z.push(t.before),void 0!==t.after&&G.push(t.after)):"remove"===o?(void 0!==t.before&&J.push(t.before),void 0!==t.after&&Q.push(t.after)):"find"===o?W.push(t):"count"===o?Y.push(t):"checkIsExists"===o&&Z.push(t)},O=function(t,i,r){var e,n;g(t),REMOVE_TO_DELETE(t),void 0!==s&&(e=s.check(t)),void 0!==e&&e.checkHasError()===!0?i({validErrors:e.getErrors()}):NEXT([function(o){EACH(q,function(e){var a=e(t,i,o,r);n!==!0&&a===!1&&(n=!0)}),n!==!0&&o()},function(){return function(){$.create(t,{error:function(o){ot(o),i({errorMsg:o})},success:function(t){EACH(w,function(o){o(t,r)}),o.BROADCAST({roomName:P+"/create",methodName:"create",data:t}),EACH(t,function(i,r){o.BROADCAST({roomName:P+"/"+r+"/"+i+"/create",methodName:"create",data:t})}),i({savedData:t})}})}}])},p=function(o,t,i){var r;$.get(o,{error:function(o){ot(o),t({errorMsg:o})},notExists:function(){t()},success:function(o){EACH(y,function(e){var n=e(o,t,i);r!==!0&&n===!1&&(r=!0)}),r!==!0&&t({savedData:o})}})},M=function(t,i,r){var e,n;void 0!==f&&(e=f.checkExceptUndefined(t)),void 0!==e&&e.checkHasError()===!0?i({validErrors:e.getErrors()}):NEXT([function(o){EACH(z,function(e){var a=e(t,i,o,r);n!==!0&&a===!1&&(n=!0)}),n!==!0&&o()},function(){return function(){$.update(t,{error:function(o){ot(o),i({errorMsg:o})},notExists:function(){i()},success:function(t){void 0!==t&&(EACH(G,function(o){o(t,r)}),o.BROADCAST({roomName:P+"/"+t.id,methodName:"update",data:t}),EACH(t,function(i,r){o.BROADCAST({roomName:P+"/"+r+"/"+i+"/update",methodName:"update",data:t})})),i({savedData:t})}})}}])},R=function(t,i,r){var e;NEXT([function(o){EACH(J,function(n){var a=n(t,i,o,r);e!==!0&&a===!1&&(e=!0)}),e!==!0&&o()},function(){return function(){$.remove(t,{error:function(o){ot(o),i({errorMsg:o})},notExists:function(){i()},success:function(t){void 0!==t&&(EACH(Q,function(o){o(t,r)}),o.BROADCAST({roomName:P+"/"+t.id,methodName:"remove",data:t}),EACH(t,function(i,r){o.BROADCAST({roomName:P+"/"+r+"/"+i+"/remove",methodName:"remove",data:t})})),i({savedData:t})}})}}])},x=function(o,t,i){var r;$.find(o,{error:function(o){ot(o),t({errorMsg:o})},success:function(o){EACH(W,function(e){var n=e(o,t,i);r!==!0&&n===!1&&(r=!0)}),r!==!0&&t({savedDataSet:o})}})},K=function(o,t,i){var r;$.count(o,{error:function(o){ot(o),t({errorMsg:o})},success:function(o){EACH(Y,function(e){var n=e(o,t,i);r!==!0&&n===!1&&(r=!0)}),r!==!0&&t({count:o})}})},X=function(o,t,i){var r;$.checkIsExists(o,{error:function(o){ot(o),t({errorMsg:o})},success:function(o){EACH(Z,function(){var e=Z(o,t,i);r!==!0&&e===!1&&(r=!0)}),r!==!0&&t({isExists:o})}})},e!==!1&&(i.create=k=function(o,t){var i,r,e;void 0!==t&&(CHECK_IS_DATA(t)!==!0?i=t:(i=t.success,r=t.notValid,e=t.error)),O(o,function(o){var t=o.errorMsg,n=o.validErrors,a=o.savedData;void 0!==t?void 0!==e&&e(t):void 0!==n?void 0!==r&&r(n):void 0!==i&&i(a)})}),n!==!1&&(i.get=B=function(o,t){var i,r,e;void 0===t&&(t=o,o=void 0),CHECK_IS_DATA(t)!==!0?i=t:(i=t.success,r=t.notExists,e=t.error),p(o,function(o){var t,n;void 0!==o&&(t=o.errorMsg,n=o.savedData),void 0!==t?void 0!==e&&e(t):void 0===n?void 0!==r&&r():i(n)})}),a!==!1&&(i.update=b=function(o,t){var i,r,e,n;REMOVE_TO_DELETE(o),void 0!==t&&(CHECK_IS_DATA(t)!==!0?i=t:(i=t.success,r=t.notExists,e=t.notValid,n=t.error)),M(o,function(o){var t,a,c;void 0!==o&&(t=o.errorMsg,a=o.validErrors,c=o.savedData),void 0!==t?void 0!==n&&n(t):void 0!==a?void 0!==e&&e(a):void 0===c?void 0!==r&&r(a):void 0!==i&&i(c)})}),c!==!1&&(i.remove=L=function(o,t){var i,r,e;void 0!==t&&(CHECK_IS_DATA(t)!==!0?i=t:(i=t.success,r=t.notExists,e=t.error)),R(o,function(o){var t,n;void 0!==o&&(t=o.errorMsg,n=o.savedData),void 0!==t?void 0!==e&&e(t):void 0===n?void 0!==r&&r():void 0!==i&&i(n)})}),d!==!1&&(i.find=V=function(o,t){var i,r;void 0===t&&(t=o,o=void 0),void 0!==t&&(CHECK_IS_DATA(t)!==!0?i=t:(i=t.success,r=t.error)),x(o,function(o){var t=o.errorMsg,e=o.savedDataSet;void 0!==t?void 0!==r&&r(t):i(e)})}),u!==!1&&(i.count=U=function(o,t){var i,r;void 0===t&&(t=o,o=void 0),void 0!==t&&(CHECK_IS_DATA(t)!==!0?i=t:(i=t.success,r=t.error)),K(o,function(o){var t=o.errorMsg,e=o.count;void 0!==t?void 0!==r&&r(t):i(e)})}),v!==!1&&(i.checkIsExists=F=function(o,t){var i,r;void 0===t&&(t=o,o=void 0),void 0!==t&&(CHECK_IS_DATA(t)!==!0?i=t:(i=t.success,r=t.error)),X(o,function(o){var t=o.errorMsg,e=o.isExists;void 0!==t?void 0!==r&&r(t):i(e)})}),o.ROOM(P,function(o,t){var i=o.roles;void 0===i&&(i=o.roles=[]),e!==!1&&t("create",function(t,r){void 0===E||CHECK_IS_EXISTS({data:i,value:E})===!0?O(t,r,o):r({isNotAuthed:!0})}),n!==!1&&t("get",function(t,r){void 0===C||CHECK_IS_EXISTS({data:i,value:C})===!0?p(t,r,o):r({isNotAuthed:!0})}),a!==!1&&t("update",function(t,r){void 0===A||CHECK_IS_EXISTS({data:i,value:A})===!0?M(t,r,o):r({isNotAuthed:!0})}),c!==!1&&t("remove",function(t,r){void 0===S||CHECK_IS_EXISTS({data:i,value:S})===!0?R(t,r,o):r({isNotAuthed:!0})}),d!==!1&&t("find",function(t,r){void 0===m||CHECK_IS_EXISTS({data:i,value:m})===!0?(void 0!==t&&delete t.isFindAll,x(t,r,o)):r({isNotAuthed:!0})}),u!==!1&&t("count",function(t,r){void 0===D||CHECK_IS_EXISTS({data:i,value:D})===!0?K(t,r,o):r({isNotAuthed:!0})}),v!==!1&&t("checkIsExists",function(t,r){void 0===_||CHECK_IS_EXISTS({data:i,value:_})===!0?X(t,r,o):r({isNotAuthed:!0})})})}})})});