FOR_BOX(function(o){"use strict";o.MODEL=CLASS({init:function(e,t,n){var i,r,c,d,u,v,a,s,E,O,A,f,C,R,N,l,m,g,h,D,x,I,M,S,P,T,H,U,L=n.roomServerName,p=n.name,_=n.initData,b=n.methodConfig,k=(n.isNotUsingObjectId,o.ROOM({roomServerName:L,name:p}));void 0!==b&&(i=b.create,r=b.get,c=b.update,d=b.remove,u=b.find,v=b.count,a=b.checkIsExists,void 0!==i&&(s=i.valid),void 0!==c&&(E=c.valid)),t.getName=O=function(){return p},t.getInitData=A=function(){return _},t.getCreateValid=f=function(){return s},t.getUpdateValid=C=function(){return E},t.getRoom=R=function(){return k},i!==!1&&(t.create=N=function(e,t){var n,i,r,c,d;void 0!==t&&(CHECK_IS_DATA(t)!==!0?n=t:(n=t.success,i=t.notValid,r=t.notAuthed,c=t.error)),void 0!==_&&EACH(_,function(o,t){e[t]=o}),void 0!==s&&(d=s.check(e)),void 0!==d&&d.checkHasError()===!0?void 0!==i?i(d.getErrors()):console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/create` NOT VALID!: ",d.getErrors()):k.send({methodName:"create",data:e},function(e){var t,d,u,v;void 0!==e?(t=e.errorMsg,d=e.validErrors,u=e.isNotAuthed,v=e.savedData,void 0!==t?void 0!==c?c(t):console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/create` ERROR: "+t):void 0!==d?void 0!==i?i(d):console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/create` NOT VALID!: ",d):u===!0?void 0!==r?r():console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/create` NOT AUTHED!"):void 0!==n&&n(v)):void 0!==n&&n()})}),r!==!1&&(t.get=l=function(e,t){var n,i,r,c;CHECK_IS_DATA(t)!==!0?n=t:(n=t.success,i=t.notExists,r=t.notAuthed,c=t.error),k.send({methodName:"get",data:e},function(e){var t,d,u;void 0!==e&&(t=e.errorMsg,d=e.isNotAuthed,u=e.savedData),void 0!==t?void 0!==c?c(t):console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/get` ERROR: "+t):d===!0?void 0!==r?r():console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/get` NOT AUTHED!"):void 0===u?void 0!==i?i():console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/get` NOT EXISTS!"):void 0!==n&&n(u)})},t.getWatching=m=function(e,n){var i,r,c,d,u,v;return CHECK_IS_DATA(n)!==!0?i=n:(i=n.success,r=n.notExists,c=n.notAuthed,d=n.error),t.get(e,{success:function(e){var t;u!==!0&&void 0!==i&&(v=o.ROOM(p+"/"+e.id),i(e,function(o){v.on("update",o)},function(o){v.on("remove",function(e){o(e),t()})},t=function(){void 0!==v&&(v.exit(),v=void 0)}))},notExists:r,notAuthed:c,error:d}),OBJECT({init:function(o,e){var t;e.exit=t=function(){void 0!==v&&v.exit(),u=!0}}})}),c!==!1&&(t.update=g=function(e,t){var n,i,r,c,d,u,v,a,s,O,A=e.id,f=e.$inc,C=e.$push,R=e.$pull;void 0!==t&&(CHECK_IS_DATA(t)!==!0?n=t:(n=t.success,i=t.notValid,r=t.notExists,c=t.notAuthed,d=t.error)),void 0!==E&&(u=E.checkForUpdate(e),void 0!==f&&(v=E.checkForUpdate(f)),void 0!==C&&(a=E.checkForUpdate(RUN(function(){var o={};return EACH(C,function(e,t){o[t]=[e]}),o}))),void 0!==R&&(s=E.checkForUpdate(RUN(function(){var o={};return EACH(R,function(e,t){o[t]=[e]}),o})))),e.id=A,e.$inc=f,e.$push=C,e.$pull=R,void 0!==E&&(u.checkHasError()===!0||void 0!==v&&v.checkHasError()===!0||void 0!==a&&a.checkHasError()===!0||void 0!==s&&s.checkHasError()===!0)?(O=COMBINE([u.getErrors(),void 0===v?{}:v.getErrors(),void 0===a?{}:a.getErrors(),void 0===s?{}:s.getErrors()]),void 0!==i?i(O):console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/update` NOT VALID!: ",O)):k.send({methodName:"update",data:e},function(e){var t,u,v,a,s;void 0!==e&&(t=e.errorMsg,u=e.validErrors,v=e.isNotAuthed,a=e.savedData,s=e.originData),void 0!==t?void 0!==d?d(t):console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/update` ERROR: "+t):void 0!==u?void 0!==i?i(u):console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/update` NOT VALID!: ",u):v===!0?void 0!==c?c():console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/update` NOT AUTHED!"):void 0===a?void 0!==r?r():console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/update` NOT EXISTS!"):void 0!==n&&n(a,s)})}),d!==!1&&(t.remove=h=function(e,t){var n,i,r,c;void 0!==t&&(CHECK_IS_DATA(t)!==!0?n=t:(n=t.success,i=t.notExists,r=t.notAuthed,c=t.error)),k.send({methodName:"remove",data:e},function(e){var t,d,u;void 0!==e&&(t=e.errorMsg,d=e.isNotAuthed,u=e.originData),void 0!==t?void 0!==c?c(t):console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/remove` ERROR: "+t):d===!0?void 0!==r?r():console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/remove` NOT AUTHED!"):void 0===u?void 0!==i?i():console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/remove` NOT EXISTS!"):void 0!==n&&n(u)})}),u!==!1&&(t.find=D=function(e,t){var n,i,r;void 0===t&&(t=e,e=void 0),CHECK_IS_DATA(t)!==!0?n=t:(n=t.success,i=t.notAuthed,r=t.error),k.send({methodName:"find",data:e},function(e){var t=e.errorMsg,c=e.isNotAuthed,d=e.savedDataSet;void 0!==t?void 0!==r?r(t):console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/find` ERROR: "+t):c===!0?void 0!==i?i():console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/find` NOT AUTHED!"):void 0!==n&&n(d)})},t.findWatching=x=function(e,n){var i,r,c,d,u={};return void 0===n&&(n=e,e=void 0),CHECK_IS_DATA(n)!==!0?i=n:(i=n.success,r=n.notAuthed,c=n.error),t.find(e,{success:function(e){var t;d!==!0&&void 0!==i&&(EACH(e,function(e){var t=e.id;u[t]=o.ROOM(p+"/"+t)}),i(e,function(o,e){u[o].on("update",e)},function(o,e){u[o].on("remove",function(n){e(n),t(o)})},t=function(o){void 0!==u[o]&&(u[o].exit(),delete u[o])}))},notAuthed:r,error:c}),OBJECT({init:function(o,e){var t;e.exit=t=function(){EACH(u,function(o){o.exit()}),d=!0}}})}),v!==!1&&(t.count=I=function(e,t){var n,i,r;void 0===t&&(t=e,e=void 0),CHECK_IS_DATA(t)!==!0?n=t:(n=t.success,i=t.notAuthed,r=t.error),k.send({methodName:"count",data:e},function(e){var t=e.errorMsg,c=e.isNotAuthed,d=e.count;void 0!==t?void 0!==r?r(t):console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/count` ERROR: "+t):c===!0?void 0!==i?i():console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/count` NOT AUTHED!"):void 0!==n&&n(d)})}),a!==!1&&(t.checkIsExists=M=function(e,t){var n,i,r;void 0===t&&(t=e,e=void 0),CHECK_IS_DATA(t)!==!0?n=t:(n=t.success,i=t.notAuthed,r=t.error),k.send({methodName:"checkIsExists",data:e},function(e){var t=e.errorMsg,c=e.isNotAuthed,d=e.isExists;void 0!==t?void 0!==r?r(t):console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/checkIsExists` ERROR: "+t):c===!0?void 0!==i?i():console.log("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+p+"/checkIsExists` NOT AUTHED!"):void 0!==n&&n(d)})}),t.onNew=S=function(e,t){var n;return void 0===t?(t=e,(n=o.ROOM(p+"/create")).on("create",t)):void 0===e?(n=o.ROOM(p+"/create")).on("create",t):EACH(e,function(i,r){return(n=o.ROOM(p+"/"+r+"/"+i+"/create")).on("create",function(o){EACH(e,function(e,t){return o[t]!==e?!1:void 0})===!0&&t(o)}),!1}),OBJECT({init:function(o,e){var t;e.exit=t=function(){void 0!==n&&n.exit()}}})},t.onNewWatching=P=function(e,t){var n,i=[],r=function(e){var n,r,c=e.id;i.push(n=o.ROOM(p+"/"+c)),t(e,function(o){n.on("update",o)},function(o){n.on("remove",function(e){o(e),r()})},r=function(){n.exit(),REMOVE({array:i,value:n})})};return void 0===t?(t=e,(n=o.ROOM(p+"/create")).on("create",function(o){r(o)})):void 0===e?(n=o.ROOM(p+"/create")).on("create",function(o){r(o)}):EACH(e,function(t,i){return(n=o.ROOM(p+"/"+i+"/"+t+"/create")).on("create",function(o){EACH(e,function(e,t){return o[t]!==e?!1:void 0})===!0&&r(o)}),!1}),OBJECT({init:function(o,e){var t;e.exit=t=function(){void 0!==n&&n.exit(),EACH(i,function(o){o.exit()})}}})},u!==!1&&(t.onNewAndFind=T=function(o,e){var t,n,i,r,c,d,u,v,a;return void 0===e&&(e=o,o=void 0),void 0!==o&&(t=o.properties,n=o.filter,i=o.sort,r=o.start,c=o.count),CHECK_IS_DATA(e)!==!0?u=e:(u=e.success,v=e.notAuthed,a=e.error),void 0!==n||void 0!==i||void 0!==r&&0!==r||(d=S(t,u)),D({filter:COMBINE([t,n]),sort:i,start:r,count:c},{success:REVERSE_EACH(u),notAuthed:v,error:a}),OBJECT({init:function(o,e){var t;e.exit=t=function(){void 0!==d&&d.exit()}}})},t.onNewAndFindWatching=H=function(o,e){var t,n,i,r,c,d,u,v,a,s;return void 0===e&&(e=o,o=void 0),void 0!==o&&(t=o.properties,n=o.filter,i=o.sort,r=o.start,c=o.count),CHECK_IS_DATA(e)!==!0?v=e:(v=e.success,a=e.notAuthed,s=e.error),void 0!==n||void 0!==i||void 0!==r&&0!==r||(d=P(t,v)),u=x({filter:COMBINE([t,n]),sort:i,start:r,count:c},{success:function(o,e,t){REVERSE_EACH(o,function(o){v(o,function(t){e(o.id,t)},function(e){t(o.id,e)})})},notAuthed:a,error:s}),OBJECT({init:function(o,e){var t;e.exit=t=function(){void 0!==d&&d.exit(),u.exit()}}})}),t.onRemove=U=function(e,t){var n;return void 0===t?(t=e,(n=o.ROOM(p+"/remove")).on("remove",t)):EACH(e,function(i,r){return(n=o.ROOM(p+"/"+r+"/"+i+"/remove")).on("remove",function(o){EACH(e,function(e,t){return o[t]!==e?!1:void 0})===!0&&t(o)}),!1}),OBJECT({init:function(o,e){var t;e.exit=t=function(){void 0!==n&&n.exit()}}})}}})});