global.CONNECT_TO_ROOM_SERVER=METHOD(function(e){"use strict";var o,t,a,d,r,m,i="__",n={},v={},u={},c={},N={},E={},h={};return e.checkIsConnected=o=function(e){return void 0===e&&(e=i),void 0===c[e]&&(c[e]=!1),c[e]},e.enterRoom=t=function(e){var o,t=e.roomServerName,a=e.roomName;void 0===t&&(t=i),o=n[t],void 0===o&&(o=n[t]=[]),o.push(a),void 0!==h[t]&&h[t]({methodName:"__ENTER_ROOM",data:a})},e.on=a=function(e,o){var t,a=e.roomServerName,d=e.methodName;void 0===a&&(a=i),t=v[a],void 0===t&&(t=v[a]=[]),t.push({methodName:d,method:o}),void 0!==N[a]&&N[a](d,o)},e.off=d=function(e,o){var t,a=e.roomServerName,d=e.methodName;void 0===a&&(a=i),t=v[a],void 0!==E[a]&&E[a](d,o),void 0!==t&&(void 0!==o?REMOVE(t,function(e){return e.methodName===d&&e.method===o}):REMOVE(t,function(e){return e.methodName===d}),0===t.length&&delete v[a])},e.send=r=function(e,o){var t,a=e.roomServerName,d=e.methodName,r=e.data;void 0===a&&(a=i),void 0===h[a]?(t=u[a],void 0===t&&(t=u[a]=[]),t.push({params:{methodName:d,data:r},callback:o})):h[a]({methodName:d,data:r},o)},e.exitRoom=m=function(e){var o,t=e.roomServerName,a=e.roomName;void 0===t&&(t=i),o=n[t],void 0===o&&(o=n[t]=[]),void 0!==h[t]&&h[t]({methodName:"__EXIT_ROOM",data:a}),REMOVE({array:o,value:a})},{run:function(e,o){var t,a,d=e.name;void 0===d&&(d=i),void 0!==o&&(CHECK_IS_DATA(o)!==!0?t=o:(t=o.success,a=o.error)),CONNECT_TO_WEB_SOCKET_SERVER({host:e.host,port:e.port,fixRequestURI:e.fixRequestURI},{error:a,success:function(e,o,a){var r=n[d],m=v[d],i=u[d];N[d]=e,E[d]=o,h[d]=a,void 0!==r&&EACH(r,function(e){a({methodName:"__ENTER_ROOM",data:e})}),void 0!==m&&EACH(m,function(o){e(o.methodName,o.method)}),void 0!==i&&EACH(i,function(e){a(e.params,e.callback)}),delete u[d],void 0!==t&&t(e,o,a),c[d]=!0,e("__DISCONNECTED",function(){delete N[d],delete E[d],delete h[d],c[d]=!1})}})}}});