FOR_BOX(function(o){"use strict";o.BROADCAST=METHOD({run:function(t){var a=o.boxName+"/"+t.roomName,E=t.methodName,n=t.data;LAUNCH_ROOM_SERVER.broadcast({roomName:a,methodName:E,data:n}),void 0!==CPU_CLUSTERING.broadcast&&CPU_CLUSTERING.broadcast({methodName:"__LAUNCH_ROOM_SERVER__MESSAGE",data:{roomName:a,methodName:E,data:n}}),void 0!==SERVER_CLUSTERING.broadcast&&SERVER_CLUSTERING.broadcast({methodName:"__LAUNCH_ROOM_SERVER__MESSAGE",data:{roomName:a,methodName:E,data:n}})}})}),FOR_BOX(function(o){"use strict";o.ROOM=METHOD({run:function(t,a){LAUNCH_ROOM_SERVER.addInitRoomFunc(o.boxName+"/"+t,a)}})}),global.CONNECT_TO_ROOM_SERVER=CONNECT_TO_ROOM_SERVER=METHOD(function(o){"use strict";var t,a,E,n,e,_,R,d,i=[],u=[],O=[];return o.enterRoom=n=function(o){void 0===E?i.push(o):E({methodName:"__ENTER_ROOM",data:o})},o.on=e=function(o,a){void 0===t?u.push({methodName:o,method:a}):t(o,a)},o.off=_=function(o,t){void 0!==u?void 0!==t?REMOVE(u,function(a){return a.methodName===o&&a.method===t}):REMOVE(u,function(t){return t.methodName===o}):a(o,t)},o.send=R=function(o,t){void 0===E?O.push({params:o,callback:t}):E(o,t)},o.exitRoom=d=function(o){void 0!==i?REMOVE({array:i,value:o}):E({methodName:"__EXIT_ROOM",data:o})},{run:function(o,n){var e,_;CHECK_IS_DATA(n)!==!0?e=n:(e=n.success,_=n.error),CONNECT_TO_SOCKET_SERVER(o,{error:_,success:function(o,n,_){t=o,a=n,E=_,EACH(i,function(o){E({methodName:"__ENTER_ROOM",data:o})}),i=void 0,EACH(u,function(o){t(o.methodName,o.method)}),u=void 0,EACH(O,function(o){E(o.params,o.callback)}),O=void 0,t("__DISCONNECTED",function(){t=void 0,a=void 0,E=void 0}),void 0!==e&&e(o,n,_)}})}}}),global.LAUNCH_ROOM_SERVER=LAUNCH_ROOM_SERVER=CLASS(function(o){"use strict";var t,a,E={},n={};return o.addInitRoomFunc=t=function(o,t){void 0===E[o]&&(E[o]=[]),E[o].push(t)},o.broadcast=a=function(o){var t=o.roomName,a=n[t];void 0!==a&&EACH(a,function(a){a({methodName:t+"/"+o.methodName,data:o.data})})},{init:function(o,t,e){var _,R;void 0!==CPU_CLUSTERING.on&&CPU_CLUSTERING.on("__LAUNCH_ROOM_SERVER__MESSAGE",a),void 0!==SERVER_CLUSTERING.on&&SERVER_CLUSTERING.on("__LAUNCH_ROOM_SERVER__MESSAGE",function(o){a(o),void 0!==CPU_CLUSTERING.broadcast&&CPU_CLUSTERING.broadcast({methodName:"__LAUNCH_ROOM_SERVER__MESSAGE",data:o})}),_=MULTI_PROTOCOL_SOCKET_SERVER(e,function(o,t,a,e){var _={};t("__ENTER_ROOM",function(R){var d=E[R],i=n[R];void 0===_[R]?(_[R]=1,void 0!==d&&EACH(d,function(E){E(o,function(o,a){t(R+"/"+o,a)},function(o,t){a(R+"/"+o,t)},function(o,t){e({methodName:R+"/"+o.methodName,data:o.data},t)})}),void 0===i&&(i=n[R]=[]),i.push(e)):_[R]+=1}),t("__EXIT_ROOM",function(o){void 0!==_[o]&&(_[o]-=1,0===_[o]&&(REMOVE({array:n[o],value:e}),0===n[o].length&&delete n[o],delete _[o]))}),t("__DISCONNECTED",function(){EACH(_,function(o,t){REMOVE({array:n[t],value:e}),0===n[t].length&&delete n[t]}),_=void 0})}),t.getWebSocketFixRequest=R=function(){return _.getWebSocketFixRequest()}}}});