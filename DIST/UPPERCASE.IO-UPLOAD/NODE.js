OVERRIDE(NODE_CONFIG,function(e){global.NODE_CONFIG=NODE_CONFIG=COMBINE_DATA({origin:e,extend:{maxUploadFileMB:10}})}),global.UPLOAD_SERVER=UPLOAD_SERVER=METHOD(function(){"use strict";var e=require("http"),o=require("fs"),i=require("querystring"),n=require("formidable").IncomingForm;return{run:function(t,r){var s,E,d,a,c,u,O,R,S,l=t.port,f=t.securedPort,C=t.securedKeyFilePath,p=t.securedCertFilePath,A=t.uploadPath;CHECK_IS_DATA(r)!==!0?E=r:(s=r.upload,CHECK_IS_DATA(s)!==!0?E=s:(E=s.success,d=s.error,a=s.overFileSize),c=r.serve,CHECK_IS_DATA(c)!==!0?u=c:(u=s.requestListener,O=s.error,R=s.notExistsResource)),o.exists(A,function(r){r===!1?console.log(CONSOLE_RED("[UPPERCASE.IO-UPLOAD_REQUEST] NOT EXISTS FOLDER!: "+A)):(S=function(e,o){var r,s,c,S,l,f,C,p,v,P=A,T=e.headers,_=e.url,D=e.method.toUpperCase(),I=T["X-Forwarded-For"];void 0===I&&(I=e.connection.remoteAddress),-1!=_.indexOf("?")&&(s=_.substring(_.indexOf("?")+1),_=_.substring(0,_.indexOf("?"))),_=_.substring(1),f={headers:T,uri:_,method:D,params:i.parse(s),ip:I,cookies:PARSE_COOKIE_STR(T.cookie),nativeReq:e},C=function(e){var i,n,t,r,s,E;void 0!==e&&(i=e.statusCode,n=e.headers,t=e.contentType,r=e.content,s=e.encoding,E=e.cacheTime),void 0===i&&(i=200),void 0===n&&(n={}),void 0!==t&&(n["Content-Type"]=t,void 0===s&&(s=WEB_SERVER.getEncodingFromContentType(t))),void 0!==E&&(n.ETag=E,n["Last-Modified"]=new Date(E).toUTCString()),o.writeHead(i,n),o.end(r,s)},"POST"===D?(c=new n,S=[],l={},c.uploadDir=P,c.on("field",function(e,o){l[e]=o}).on("file",function(e,o){S.push({tempPath:o.path,size:o.size,name:o.name,type:o.type,lastModifiedTime:o.lastModifiedDate})}).on("end",function(){NEXT(S,[function(e,o){var i=e.tempPath,n=e.size;if(delete e.tempPath,e.ip=I,n>1024*NODE_CONFIG.maxUploadFileMB*1024)return void 0!==a?a(i,n):console.log(CONSOLE_YELLOW("[UPPERCASE.IO-UPLOAD_REQUEST] FILE SIZE IS TOO BIG!("+n+"):"+i)),!1;EACH(l,function(o,i){""!==o.trim()&&(e[i]=o)});var t=e.type;"image/png"===t||"image/jpeg"===t||"image/gif"===t?IMAGEMAGICK_EXPORT_METADATA(i,{error:function(){o(e)},success:function(n){void 0!==n.exif?(e.exif=n.exif,IMAGEMAGICK_CONVERT([i,"-auto-orient",i],{error:errorHandler,success:o})):o()}}):o()},function(){return function(){E(S,f,C)}}])}).on("error",function(e){var o=e.toString();console.log("[UPPERCASE.IO-UPLOAD_REQUEST] ERROR: "+o),void 0!==d&&d(o)}),c.parse(e)):"GET"===D&&(void 0!==u&&(r=u(f,C,onDisconnected,function(e){P=e}),_=f.uri,D=f.method,t=f.params,T=f.headers),p=function(e){void 0!==R&&R(e,f,C),f.isResponsed!==!0&&C({statusCode:404})},v=function(e){console.log(CONSOLE_RED("[UPPERCASE.JS-RESOURCE_SERVER] ERROR: "+e)),void 0!==O&&O(e,f,C),f.isResponsed!==!0&&C({statusCode:500})},READ_FILE(P+"/"+_,{notExists:p,error:v,success:function(e){C({content:e,headers:{}})}}))},void 0!==l&&e.createServer(S).listen(l),void 0!==f&&https.createServer({key:o.readFileSync(C),cert:o.readFileSync(p)},S).listen(f),console.log("[UPPERCASE.IO-UPLOAD_SERVER] RUNNING UPLOAD SERVER..."+(void 0===l?"":" (PORT:"+l+")")+(void 0===f?"":" (SECURED PORT:"+f+")")))})}}});