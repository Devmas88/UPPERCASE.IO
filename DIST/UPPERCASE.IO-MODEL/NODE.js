FOR_BOX(function(o){"use strict";OVERRIDE(o.MODEL,function(){o.MODEL=CLASS({init:function(r,e,i){var t,n,a,c,u,d,v,s,f,E,C,A,S,m,l,h,D,_,H,I,g,N,T,p,M,O,R,K,X,k,x,B,b,L,U,V,F,P=i.name,j=i.config,q=[],w=[],y=[],z=[],G=[],J=[],Q=[],W=[],Y=[],Z=[],$=o.DB(P),or=function(r){console.log(CONSOLE_RED("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+P+"` ERROR: "+r))};e.getName=_=function(){return P},void 0!==j&&(t=j.create,n=j.get,a=j.update,c=j.remove,u=j.find,d=j.count,v=j.checkIsExists,void 0!==t&&(s=t.valid,E=t.role,D=t.initData),void 0!==n&&(C=n.role),void 0!==a&&(f=a.valid,A=a.role),void 0!==c&&(S=c.role),void 0!==u&&(m=u.role),void 0!==d&&(l=d.role),void 0!==v&&(h=v.role)),r.getCreateValid=H=function(){return s},r.getUpdateValid=I=function(){return f},r.initData=g=function(o){return void 0!==D&&D(o),o},e.getDB=N=function(){return $},r.on=T=function(o,r){"create"===o?(void 0!==r.before&&q.push(r.before),void 0!==r.after&&w.push(r.after)):"get"===o?y.push(r):"update"===o?(void 0!==r.before&&z.push(r.before),void 0!==r.after&&G.push(r.after)):"remove"===o?(void 0!==r.before&&J.push(r.before),void 0!==r.after&&Q.push(r.after)):"find"===o?W.push(r):"count"===o?Y.push(r):"checkIsExists"===o&&Z.push(r)},p=function(r,e,i){var t,n;g(r),void 0!==s&&(t=s.check({data:r})),void 0!==t&&t.checkHasError()===!0?e({validErrors:t.getErrors()}):NEXT([function(o){EACH(q,function(t){var a=t(r,e,o,i);n!==!0&&a===!1&&(n=!0)}),n!==!0&&o()},function(){return function(){$.create(r,{error:function(o){or(o),e({errorMsg:o})},success:function(r){EACH(w,function(o){o(r,i)}),o.BROADCAST({roomName:P+"/create",methodName:"create",data:r}),EACH(r,function(e,i){o.BROADCAST({roomName:P+"/"+i+"/"+e+"/create",methodName:"create",data:r})}),e({savedData:r})}})}}])},M=function(o,r,e){var i;$.get(o,{error:function(o){or(o),r({errorMsg:o})},success:function(o){EACH(y,function(o){var t=o(data,r,e);i!==!0&&t===!1&&(i=!0)}),i!==!0&&r({savedData:o})}})},O=function(r,e,i){var t,n;void 0!==f&&(t=f.check({data:r,isExceptUndefined:!0})),void 0!==t&&t.checkHasError()===!0?e({validErrors:t.getErrors()}):NEXT([function(o){EACH(z,function(t){var a=t(r,e,o,i);n!==!0&&a===!1&&(n=!0)}),n!==!0&&o()},function(){return function(){$.update(r,{error:function(o){or(o),e({errorMsg:o})},success:function(r){void 0!==r&&(EACH(G,function(o){o(r,i)}),o.BROADCAST({roomName:P+"/"+r.id,methodName:"update",data:r}),EACH(r,function(e,i){o.BROADCAST({roomName:P+"/"+i+"/"+e+"/update",methodName:"update",data:r})})),e({savedData:r})}})}}])},R=function(r,e,i){var t;NEXT([function(o){EACH(J,function(n){var a=n(r,e,o,i);t!==!0&&a===!1&&(t=!0)}),t!==!0&&o()},function(){return function(){$.remove(r,{error:function(o){or(o),e({errorMsg:o})},success:function(r){void 0!==r&&(EACH(Q,function(o){o(r,i)}),o.BROADCAST({roomName:P+"/"+r.id,methodName:"remove",data:r}),EACH(r,function(e,i){o.BROADCAST({roomName:P+"/"+i+"/"+e+"/remove",methodName:"remove",data:r})})),e({savedData:r})}})}}])},K=function(o,r,e){var i;$.find(o,{error:function(o){or(o),r({errorMsg:o})},success:function(o){EACH(W,function(t){var n=t(o,r,e);i!==!0&&n===!1&&(i=!0)}),i!==!0&&r({savedDataSet:o})}})},X=function(o,r,e){var i;$.count(o,{error:function(o){or(o),r({errorMsg:o})},success:function(o){EACH(Y,function(t){var n=t(o,r,e);i!==!0&&n===!1&&(i=!0)}),i!==!0&&r({count:o})}})},k=function(o,r,e){var i;$.checkIsExists(o,{error:function(o){or(o),r({errorMsg:o})},success:function(o){EACH(Z,function(){var t=Z(o,r,e);i!==!0&&t===!1&&(i=!0)}),i!==!0&&r({isExists:o})}})},t!==!1&&(e.create=x=function(o,r){var e,i,t;void 0!==r&&(CHECK_IS_DATA(r)!==!0?e=r:(e=r.success,i=r.fail,t=r.error)),p(o,function(o){var r=o.errorMsg,n=o.validErrors,a=o.savedData;void 0!==r?void 0!==t&&t(r):void 0!==n?void 0!==i&&i(n):void 0!==e&&e(a)})}),n!==!1&&(e.get=B=function(o,r){var e,i,t;void 0===r&&(r=o,o=void 0),CHECK_IS_DATA(r)!==!0?e=r:(e=r.success,i=r.fail,t=r.error),M(o,function(o){var r=o.errorMsg,n=o.savedData;void 0!==r?void 0!==t&&t(r):void 0===n?void 0!==i&&i():e(n)})}),a!==!1&&(e.update=b=function(o,r){var e,i,t;void 0!==r&&(CHECK_IS_DATA(r)!==!0?e=r:(e=r.success,i=r.fail,t=r.error)),O(o,function(o){var r=o.errorMsg,n=o.validErrors,a=o.savedData;void 0!==r?void 0!==t&&t(r):void 0!==n||void 0===a?void 0!==i&&i(n):void 0!==e&&e(a)})}),c!==!1&&(e.remove=L=function(o,r){var e,i,t;void 0!==r&&(CHECK_IS_DATA(r)!==!0?e=r:(e=r.success,i=r.fail,t=r.error)),R(o,function(o){var r=o.errorMsg,n=o.savedData;void 0!==r?void 0!==t&&t(r):void 0===n?void 0!==i&&i():void 0!==e&&e(n)})}),u!==!1&&(e.find=U=function(o,r){var e,i;void 0===r&&(r=o,o=void 0),void 0!==r&&(CHECK_IS_DATA(r)!==!0?e=r:(e=r.success,i=r.error)),K(o,function(o){var r=o.errorMsg,t=o.savedDataSet;void 0!==r?void 0!==i&&i(r):e(t)})}),d!==!1&&(e.count=V=function(o,r){var e,i;void 0===r&&(r=o,o=void 0),void 0!==r&&(CHECK_IS_DATA(r)!==!0?e=r:(e=r.success,i=r.error)),X(o,function(o){var r=o.errorMsg,t=o.count;void 0!==r?void 0!==i&&i(r):e(t)})}),v!==!1&&(e.checkIsExists=F=function(o,r){var e,i;void 0===r&&(r=o,o=void 0),void 0!==r&&(CHECK_IS_DATA(r)!==!0?e=r:(e=r.success,i=r.error)),k(o,function(o){var r=o.errorMsg,t=o.isExists;void 0!==r?void 0!==i&&i(r):e(t)})}),o.ROOM(P,function(o,r){var e=o.roles;void 0===e&&(e=o.roles=[]),t!==!1&&r("create",function(r,i){void 0===E||CHECK_IS_EXISTS({data:e,value:E})===!0?p(r,i,o):i({isNotAuthed:!0})}),n!==!1&&r("get",function(r,i){void 0===C||CHECK_IS_EXISTS({data:e,value:C})===!0?M(r,i,o):i({isNotAuthed:!0})}),a!==!1&&r("update",function(r,i){void 0===A||CHECK_IS_EXISTS({data:e,value:A})===!0?O(r,i,o):i({isNotAuthed:!0})}),c!==!1&&r("remove",function(r,i){void 0===S||CHECK_IS_EXISTS({data:e,value:S})===!0?R(r,i,o):i({isNotAuthed:!0})}),u!==!1&&r("find",function(r,i){void 0===m||CHECK_IS_EXISTS({data:e,value:m})===!0?(void 0!==r&&delete r.isFindAll,K(r,i,o)):i({isNotAuthed:!0})}),d!==!1&&r("count",function(i){r("remove",function(r,t){void 0===l||CHECK_IS_EXISTS({data:e,value:l})===!0?X(i,t,o):t({isNotAuthed:!0})})}),v!==!1&&r("checkIsExists",function(r,i){void 0===h||CHECK_IS_EXISTS({data:e,value:h})===!0?k(r,i,o):i({isNotAuthed:!0})})})}})})});