FOR_BOX(function(o){"use strict";OVERRIDE(o.MODEL,function(){o.MODEL=CLASS({init:function(r,n,e){var i,t,c,u,a,d,v,s,f,E,C,A,S,m,O,l,h,D,_,H,I,g,N,T,p,F,M,R,K,X,k,x,B,b,L,U,V,P=e.name,j=e.config,q=[],w=[],y=[],z=[],G=[],J=[],Q=[],W=[],Y=[],Z=[],$=o.DB(P),or=function(r){console.log(CONSOLE_RED("[UPPERCASE.IO-MODEL] `"+o.boxName+"."+P+"` ERROR: "+r))};n.getName=D=function(){return P},void 0!==j&&(i=j.create,t=j.get,c=j.update,u=j.remove,a=j.find,d=j.count,v=j.checkIsExists,void 0!==i&&(s=i.valid,E=i.role,h=i.initData),void 0!==t&&(C=t.role),void 0!==c&&(f=c.valid,A=c.role),void 0!==u&&(S=u.role),void 0!==a&&(m=a.role),void 0!==d&&(O=d.role),void 0!==v&&(l=v.role)),r.getCreateValid=_=function(){return s},r.getUpdateValid=H=function(){return f},r.initData=I=function(o){return void 0!==h&&h(o),o},n.getDB=g=function(){return $},r.on=N=function(o){"create"===o?(void 0!==funcOrFuncs.before&&q.push(funcOrFuncs.before),void 0!==funcOrFuncs.after&&w.push(funcOrFuncs.after)):"get"===o?y.push(funcOrFuncs):"update"===o?(void 0!==funcOrFuncs.before&&z.push(funcOrFuncs.before),void 0!==funcOrFuncs.after&&G.push(funcOrFuncs.after)):"remove"===o?(void 0!==funcOrFuncs.before&&J.push(funcOrFuncs.before),void 0!==funcOrFuncs.after&&Q.push(funcOrFuncs.after)):"find"===o?W.push(funcOrFuncs):"count"===o?Y.push(funcOrFuncs):"checkIsExists"===o&&Z.push(funcOrFuncs)},T=function(r,n,e){var i,t;I(r),void 0!==s&&(i=s.check({data:r})),void 0!==i&&i.checkHasError()===!0?n({validErrors:i.getErrors()}):NEXT([function(o){EACH(q,function(i){var c=i(r,n,o,e);t!==!0&&c===!1&&(t=!0)}),t!==!0&&o()},function(){return function(){$.create(r,{error:function(o){or(o),n({errorMsg:o})},success:function(r){EACH(w,function(o){o(r,e)}),o.BROADCAST({roomName:P+"/create",methodName:"create",data:r}),EACH(r,function(n,e){o.BROADCAST({roomName:P+"/"+e+"/"+n+"/create",methodName:"create",data:r})}),n({savedData:r})}})}}])},p=function(o,r,n){var e;$.get(o,{error:function(o){or(o),r({errorMsg:o})},success:function(o){EACH(y,function(o){var i=o(data,r,n);e!==!0&&i===!1&&(e=!0)}),e!==!0&&r({savedData:o})}})},F=function(r,n,e){var i,t;void 0!==f&&(i=f.check({data:r,isExceptUndefined:!0})),void 0!==i&&i.checkHasError()===!0?n({validErrors:i.getErrors()}):NEXT([function(o){EACH(z,function(i){var c=i(r,n,o,e);t!==!0&&c===!1&&(t=!0)}),t!==!0&&o()},function(){return function(){$.update(r,{error:function(o){or(o),n({errorMsg:o})},success:function(r){void 0!==r&&(EACH(G,function(o){o(r,e)}),o.BROADCAST({roomName:P+"/"+r.id,methodName:"update",data:r}),EACH(r,function(n,e){o.BROADCAST({roomName:P+"/"+e+"/"+n+"/update",methodName:"update",data:r})})),n({savedData:r})}})}}])},M=function(r,n,e){var i;NEXT([function(o){EACH(J,function(t){var c=t(r,n,o,e);i!==!0&&c===!1&&(i=!0)}),i!==!0&&o()},function(){return function(){$.remove(r,{error:function(o){or(o),n({errorMsg:o})},success:function(r){void 0!==r&&(EACH(Q,function(o){o(r,e)}),o.BROADCAST({roomName:P+"/"+r.id,methodName:"remove",data:r}),EACH(r,function(n,e){o.BROADCAST({roomName:P+"/"+e+"/"+n+"/remove",methodName:"remove",data:r})})),n({savedData:r})}})}}])},R=function(o,r,n){var e;$.find(o,{error:function(o){or(o),r({errorMsg:o})},success:function(o){EACH(W,function(i){var t=i(o,r,n);e!==!0&&t===!1&&(e=!0)}),e!==!0&&r({savedDataSet:o})}})},K=function(o,r,n){var e;$.count(o,{error:function(o){or(o),r({errorMsg:o})},success:function(o){EACH(Y,function(i){var t=i(o,r,n);e!==!0&&t===!1&&(e=!0)}),e!==!0&&r({count:o})}})},X=function(o,r,n){var e;$.checkIsExists(o,{error:function(o){or(o),r({errorMsg:o})},success:function(o){EACH(Z,function(){var i=Z(o,r,n);e!==!0&&i===!1&&(e=!0)}),e!==!0&&r({isExists:o})}})},i!==!1&&(n.create=k=function(o,r){var n,e,i;void 0!==r&&(CHECK_IS_DATA(r)!==!0?n=r:(n=r.success,e=r.fail,i=r.error)),T(o,function(o){var r=o.errorMsg,t=o.validErrors,c=o.savedData;void 0!==r?void 0!==i&&i(r):void 0!==t?void 0!==e&&e(t):void 0!==n&&n(c)})}),t!==!1&&(n.get=x=function(o,r){var n,e,i;void 0===r&&(r=o,o=void 0),CHECK_IS_DATA(r)!==!0?n=r:(n=r.success,e=r.fail,i=r.error),p(o,function(o){var r=o.errorMsg,t=o.savedData;void 0!==r?void 0!==i&&i(r):void 0===t?void 0!==e&&e():void 0!==n&&n(t)})}),c!==!1&&(n.update=B=function(o,r){var n,e,i;void 0!==r&&(CHECK_IS_DATA(r)!==!0?n=r:(n=r.success,e=r.fail,i=r.error)),F(o,function(o){var r=o.errorMsg,t=o.validErrors,c=o.savedData;void 0!==r?void 0!==i&&i(r):void 0!==t||void 0===c?void 0!==e&&e(t):void 0!==n&&n(c)})}),u!==!1&&(n.remove=b=function(o,r){var n,e,i;void 0!==r&&(CHECK_IS_DATA(r)!==!0?n=r:(n=r.success,e=r.fail,i=r.error)),M(o,function(o){var r=o.errorMsg,t=o.savedData;void 0!==r?void 0!==i&&i(r):void 0===t?void 0!==e&&e():void 0!==n&&n(t)})}),a!==!1&&(n.find=L=function(o,r){var n,e;void 0===r&&(r=o,o=void 0),void 0!==r&&(CHECK_IS_DATA(r)!==!0?n=r:(n=r.success,e=r.error)),R(o,function(o){var r=o.errorMsg,i=o.savedDataSet;void 0!==r?void 0!==e&&e(r):void 0!==n&&n(i)})}),d!==!1&&(n.count=U=function(o,r){var n,e;void 0===r&&(r=o,o=void 0),void 0!==r&&(CHECK_IS_DATA(r)!==!0?n=r:(n=r.success,e=r.error)),K(o,function(o){var r=o.errorMsg,i=o.count;void 0!==r?void 0!==e&&e(r):void 0!==n&&n(i)})}),v!==!1&&(n.checkIsExists=V=function(o,r){var n,e;void 0===r&&(r=o,o=void 0),void 0!==r&&(CHECK_IS_DATA(r)!==!0?n=r:(n=r.success,e=r.error)),X(o,function(o){var r=o.errorMsg,i=o.isExists;void 0!==r?void 0!==e&&e(r):void 0!==n&&n(i)})}),o.ROOM(P,function(o,r){var n=o.roles;void 0===n&&(n=o.roles=[]),i!==!1&&r("create",function(r,e){void 0===E||CHECK_IS_EXISTS({data:n,value:E})===!0?T(r,e,o):e({isNotAuthed:!0})}),t!==!1&&r("get",function(r,e){void 0===C||CHECK_IS_EXISTS({data:n,value:C})===!0?p(r,e,o):e({isNotAuthed:!0})}),c!==!1&&r("update",function(r,e){void 0===A||CHECK_IS_EXISTS({data:n,value:A})===!0?F(r,e,o):e({isNotAuthed:!0})}),u!==!1&&r("remove",function(r,e){void 0===S||CHECK_IS_EXISTS({data:n,value:S})===!0?M(r,e,o):e({isNotAuthed:!0})}),a!==!1&&r("find",function(r,e){void 0===m||CHECK_IS_EXISTS({data:n,value:m})===!0?(void 0!==r&&delete r.isFindAll,R(r,e,o)):e({isNotAuthed:!0})}),d!==!1&&r("count",function(e){r("remove",function(r,i){void 0===O||CHECK_IS_EXISTS({data:n,value:O})===!0?K(e,i,o):i({isNotAuthed:!0})})}),v!==!1&&r("checkIsExists",function(r,e){void 0===l||CHECK_IS_EXISTS({data:n,value:l})===!0?X(r,e,o):e({isNotAuthed:!0})})})}})})});