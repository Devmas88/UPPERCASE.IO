OVERRIDE(NODE_CONFIG,function(O){global.NODE_CONFIG=NODE_CONFIG=COMBINE([O,{maxUploadFileMB:10}])});global.UPLOAD_REQUEST=UPLOAD_REQUEST=METHOD(function(){"use strict";var n=(require("fs"),require("formidable").IncomingForm);return{run:function(e,i){var o,r,t,u=e.requestInfo,a=e.uploadPath;CHECK_IS_DATA(i)!==!0?o=i:(o=i.success,r=i.error,t=i.overFileSize),CREATE_FOLDER(a,function(){var e,i,f,E=u.method,c=u.ip,s=u.nativeReq;"POST"===E&&(e=new n,i=[],f={},e.uploadDir=a,e.on("field",function(n,e){f[n]=e}).on("file",function(n,e){i.push({path:e.path,size:e.size,name:e.name,type:e.type,lastModifiedTime:e.lastModifiedDate})}).on("end",function(){NEXT(i,[function(n,e){var o=n.path,u=n.size;if(n.ip=c,u>1024*NODE_CONFIG.maxUploadFileMB*1024)return NEXT(i,[function(n,e){REMOVE_FILE(n.path,e)},function(){return function(){void 0!==t&&t()}}]),!1;EACH(f,function(e,i){""!==e.trim()&&(n[i]=e)});var a=n.type;"image/png"===a||"image/jpeg"===a||"image/gif"===a?IMAGEMAGICK_READ_METADATA(o,{error:function(){e(n)},success:function(i){void 0!==i.exif?(n.exif=i.exif,IMAGEMAGICK_CONVERT([o,"-auto-orient",o],{error:r,success:e})):e()}}):e()},function(){return function(){o(i)}}])}).on("error",function(n){var e=n.toString();void 0!==r?r(e):console.log("[UPPERCASE.IO-UPLOAD_REQUEST] ERROR: "+e)}),e.parse(s))})}}});